configurations {
    javancss
}

dependencies {
    javancss 'org.codehaus.javancss:javancss:33.54'
}

task javancss() {
    def ignoreFailures = ignoreFailuresInCheck.toBoolean()

    // create output folders
    def reportDir = file("$project.buildDir/reports/javancss")
    reportDir.mkdirs()

    //// exclude auto-generated code and 3rd party libs
    def exclude = ['**/build/resources/**']

    ant {
        taskdef name: 'javancss',
                classname: 'javancss.JavancssAntTask',
                classpath: configurations.javancss.asPath

        javancss srcdir: 'src',
                packageMetrics: "yes",
                excludes: exclude,
                classMetrics: "yes",
                functionMetrics: "yes",
                abortOnFail: !ignoreFailures,
                generateReport: true,
                outputfile: "$reportDir/javancss.txt",
                format: 'plain',
                ccnPerFuncMax:10
    }
}